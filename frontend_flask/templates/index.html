<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <title>CS410: Job Postings Ranker</title>
    <script>
    function sendPOST() {
      let query = { query: $("#query").val() }

      $.post("/rank", query)
      .done(function (data) {
        // $("#content").html(`<hr><h3>Result</h3><pre>${JSON.stringify(data, null, 2)}</pre>`);
        const ranking = data['ranking']
        for (var i = 0; i < ranking.length; i++) {
          for (var key in ranking[i]) {
            var row = $('<tr/>');
            var name = key;
            var link = "<a href=" + ranking[i][key] + ">Link</a>";
            // console.log(name, link);
            row.append($('<td/>').html(i+1));
            row.append($('<td/>').html(name));
            row.append($('<td/>').html(link));
            $('#table').append(row)
          }
        }
      })
      .fail(function (data) {
        $("#content").html(`<hr><h3>Error - ${data.status}</h3><pre>${JSON.stringify(data, null, 2)}</pre>`);
      })
    };
    </script>
    <style>
      .container {
        padding-top: 20px;
        text-align: center;
        align-items: center;
      }

      .searchRow {

      }

      .searchbar {
        width: 90%;
      }

      .tableContainer {
        padding-top: 30px;
      }

      .table {
        text-align: center;
      }
    </style>    
  </head>
  <body>
    <main class="container">
      <h1 align="center">LinkedIn Job Posting Ranker</h1>
      <br><br>
      <div class="searchRow">
        Query: 
        <input type="text" class="searchbar" id="query" name="query" placeholder="Example: 2 years experience with SQL databases">
        <button onclick="sendPOST();" class="rankBtn">Rank</button>
      </div>

      <div class="tableContainer">
        <table class="table" id="table" align="center" border="2px">
          <tr>
            <th>Rank</th>
            <th>Company Name</th>
            <th>Application Link</th>
          </tr>
        </table>
      </div>
    </main>
  </body>
</html>